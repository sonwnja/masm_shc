# masm_shc

[![Build status](https://ci.appveyor.com/api/projects/status/y50mphwb8rtg9vh9?svg=true)](https://ci.appveyor.com/project/hasherezade/masm-shc)

A helper utility for creating shellcodes. Cleans MASM file generated by MSVC, gives refactoring hints.

+ [Demos](demos)
+ [Paper (ğŸ“° pdf)](https://vxug.fakedoma.in/papers/VXUG/Exclusive/FromaCprojectthroughassemblytoshellcodeHasherezade.pdf)
# step
1ï¼Œä½¿ç”¨å‘½ä»¤è¡Œä¸­çš„ MSVC å°†ç¤ºä¾‹ä» C ç¼–è¯‘ä¸º MASM
	cl /c /GS- /FA <æ–‡ä»¶>.cpp
2ï¼Œä½¿ç”¨ masm_shc æ¸…ç†è·å¾—çš„ MASMï¼Œå†…è”å­—ç¬¦ä¸²ç­‰ã€‚
	masm_shc.exe <æ–‡ä»¶>.asm <å·²æ¸…ç†æ–‡ä»¶>.asm
å®ƒåº”è¯¥ä¼šè‡ªåŠ¨è§£å†³å¤§éƒ¨åˆ†é—®é¢˜ã€‚å…¶ä½™é—®é¢˜åº”æŒ‰ç…§æ˜¾ç¤ºçš„æç¤ºæ‰‹åŠ¨è§£å†³ã€‚å®ƒè¿˜ä¼šé€šçŸ¥å…¥å£ç‚¹æ˜¯å¦å·²æ›´æ”¹

3ï¼Œå°† MASM ç”Ÿæˆçš„æ–‡ä»¶ç¼–è¯‘ä¸º PEï¼ˆç±»ä¼¼åœ°ï¼Œå¯¹äº 32 ä½æ–‡ä»¶ä½¿ç”¨mlï¼Œ å¯¹äº 64 ä½æ–‡ä»¶ä½¿ç”¨ml64ï¼‰
	ml <cleaned_file>.asm /link /entry:<my_entry_func>
4ï¼Œä½¿ç”¨ PE-bear ä»ç”Ÿæˆçš„ PE ä¸­è½¬å‚¨ .text éƒ¨åˆ†ã€‚è¿™å°†æ˜¯æˆ‘ä»¬çš„shellcodeã€‚
5ï¼Œä½¿ç”¨runshcæµ‹è¯•shellcodeï¼ˆè®°ä½runshcçš„bitnesså¿…é¡»å’Œshellcodeçš„bitnessä¸€æ ·ï¼‰
